#> # … with 1,694 more rows
### your code
sum(is.na(df_gapminder_raw))
df_gapminder_raw[is.na(df_gapminder_raw$country),] #迷有
df_gapminder_raw[is.na(df_gapminder_raw$continent),] #Nepal的continent有12個NA
df_gapminder_raw[is.na(df_gapminder_raw$year),]#迷有
df_gapminder_raw[is.na(df_gapminder_raw$lifeExp),] #Portugal的lifeExp有12個NA
df_gapminder_raw[is.na(df_gapminder_raw$pop),] #Puerto Rico的pop有12個NA
df_gapminder_raw[is.na(df_gapminder_raw$gdpPercap),] #Reunion的gdpPercap有12個NA
#總共有48個NA唷！
#填補遺漏值的方式
df_gapminder_raw[is.na(df_gapminder_raw)] <- 0
sum(is.na(df_gapminder_raw))
df_gapminder_clean <- df_gapminder_raw
as.tibble(df_gapminder_clean)
### your result should be
# 不一定，看你怎麼處理資料
### your text (把文字描述寫在 code chunk 中)
#綺薇把Nepal的洲補上，其他的在網路上查到很多人建議用平均值之類的補，但我覺得這份資料的各國情況都不同，不適合用附近國家的平均值來補，所以把NA變成0，但變成0之後，發現後面計算都要記得檢查有沒有因為0而被丟到奇怪的項目，有點麻煩，哭哭！
# 範例答案：我覺得 missing value 看了令人很不舒服，數值變數應該都改成 88 比較吉利，數值變數以外都應該改成 "others"
### your code
df_gapminder_clean%>%
filter(country=="Taiwan")
### your result should be
#> # A tibble: 12 x 6
#>    country continent  year lifeExp      pop gdpPercap
#>    <chr>   <chr>     <dbl>   <dbl>    <dbl>     <dbl>
#>  1 Taiwan  Asia       1952    58.5  8550362     1207.
#>  2 Taiwan  Asia       1957    62.4 10164215     1508.
#>  3 Taiwan  Asia       1962    65.2 11918938     1823.
#>  4 Taiwan  Asia       1967    67.5 13648692     2644.
#>  5 Taiwan  Asia       1972    69.4 15226039     4063.
#>  6 Taiwan  Asia       1977    70.6 16785196     5597.
#>  7 Taiwan  Asia       1982    72.2 18501390     7426.
#>  8 Taiwan  Asia       1987    73.4 19757799    11055.
#>  9 Taiwan  Asia       1992    74.3 20686918    15216.
#> 10 Taiwan  Asia       1997    75.2 21628605    20207.
#> 11 Taiwan  Asia       2002    77.0 22454239    23235.
#> 12 Taiwan  Asia       2007    78.4 23174294    28718.
### your text
#1952年到2007年之間，台灣的平均壽命越來越長，人口越來越多，人均GDP也持續增加。
### your code
df_gapminder_clean%>%
filter(country=="Taiwan")
### your result should be
#> # A tibble: 12 x 6
#>    country continent  year lifeExp      pop gdpPercap
#>    <chr>   <chr>     <dbl>   <dbl>    <dbl>     <dbl>
#>  1 Taiwan  Asia       1952    58.5  8550362     1207.
#>  2 Taiwan  Asia       1957    62.4 10164215     1508.
#>  3 Taiwan  Asia       1962    65.2 11918938     1823.
#>  4 Taiwan  Asia       1967    67.5 13648692     2644.
#>  5 Taiwan  Asia       1972    69.4 15226039     4063.
#>  6 Taiwan  Asia       1977    70.6 16785196     5597.
#>  7 Taiwan  Asia       1982    72.2 18501390     7426.
#>  8 Taiwan  Asia       1987    73.4 19757799    11055.
#>  9 Taiwan  Asia       1992    74.3 20686918    15216.
#> 10 Taiwan  Asia       1997    75.2 21628605    20207.
#> 11 Taiwan  Asia       2002    77.0 22454239    23235.
#> 12 Taiwan  Asia       2007    78.4 23174294    28718.
### your text
#1952年到2007年之間，台灣的平均壽命越來越長，人口越來越多，人均GDP也持續增加。
### your code
as.tibble(
df_gapminder_clean%>%
mutate(lifeexp_interval = ifelse(lifeExp >= "70", "too_old",
ifelse(lifeExp >= "60"&lifeExp < "70", "old",
ifelse((lifeExp < "60"&lifeExp > "0"), "young", "no"))))%>%
filter(continent == "Europe")%>%
count(lifeexp_interval))
### your result should be
# 看你怎麼處理 missing value，結果可能會有不同
### your text
#可以歐洲看到活到60、小於70歲的「old」的資料有85筆，超過70歲的「too_old」是250筆，有點活太久了。因為把所有NA變成0，所以葡萄牙的12筆NA被歸類到「no」。
# 範例：如前所述，我把數值變數的 missing value 都變成 88，在算它屬於哪個區間的時候會有影響，感覺不是好事，但我懶得改
### your code
as.tibble(
df_gapminder_clean%>%
filter(continent == "Asia",year =="1972")%>%
mutate(total_GDP = pop*gdpPercap)%>%
arrange(desc(lifeExp))%>%
select(country,total_GDP,lifeExp))
### your result should be
# 看你怎麼處理 missing value，結果可能會有不同
### your code
as.tibble(
df_gapminder_clean%>%
filter(continent == "Europe")%>%
select(country,year,lifeExp,pop)%>%
arrange(desc(pop))%>%
group_by(country)%>%
slice(1)%>%
ungroup()%>%
arrange(desc(lifeExp))%>%
slice_head(n=10)%>%
arrange(country))
### your result should be
# 看你怎麼處理 missing value，結果可能會有不同
### your code
df_gapminder_clean%>%
filter(year=="1992"|year=="2007")%>%
group_by(year)%>%
mutate(gap_lifeExp=
abs(
subset(df_gapminder_clean, year=="2007")$lifeExp-
subset(df_gapminder_clean, year=="1992")$lifeExp))%>%
ungroup()%>%
group_by(country)%>%
slice(1)%>%
ungroup()%>%
select(continent,country,gap_lifeExp)%>%
group_by(continent)%>%
slice(which.min(gap_lifeExp),which.max(gap_lifeExp))%>%
ungroup()
### your result should be
# 看你怎麼處理 missing value，結果可能會有不同
### your code
df_main_clean <- read_csv("data/AS03/df_main_clean.csv")
as_tibble(df_main_clean)
### your result should be
#> # A tibble: 1,457 x 10
#>    board  type   title   date       comments author  text      IP       link
#>    <chr>  <chr>  <chr>   <date>        <dbl> <chr>   <chr>     <chr>    <chr>
#>  1 Korea… [公告] Fw: [公… 2021-01-18       20 XDDDD5… "┌──┬│┌─… "※ 發信站:… https:/…
#>  2 Korea… [新聞] [新聞] 柳… 2021-01-18        5 jinyi … "演員柳惠英被提… "※ 發信站:… https:/…
#>  3 Korea… [閒聊] [閒聊]  … 2021-01-18      101 jay947… "花了幾個週末把… "※ 發信站:… https:/…
#>  4 Korea… [新聞] [新聞] 孫… 2021-01-18        9 jinyi … "據多名電視臺相… "※ 發信站:… https:/…
#>  5 Korea… [LIVE] [LIVE]… 2021-01-18      249 kawasa… "前輩，那支口紅… "※ 發信站:… https:/…
#>  6 Korea… [LIVE] [LIVE]… 2021-01-18      406 tcchen… "劇名:▁▁▁▁… "※ 發信站:… https:/…
#>  7 Korea… [LIVE] [LIVE]… 2021-01-18       80 diana8… "───────… "※ 發信站:… https:/…
#>  8 Korea… [心得] [心得] 惡… 2021-01-18       28 analyt… "最後一集到底來… "※ 發信站:… https:/…
#>  9 Korea… [求薦] [求薦] 想… 2021-01-18      214 greenb… "1.重刷doc… "※ 發信站:… https:/…
#> 10 Korea… <NA>   看完13集驅… 2021-01-19       35 patty6… "不知道各位大大… "※ 發信站:… https:/…
#> # … with 1,447 more rows, and 1 more variable: time <dttm>
### your code
as_tibble(count(df_main_clean,board))
#df_main_clean <- as.data.frame(table(df_main_clean$board))
#as.tibble(df_main_clean)
### your result should be
#> # A tibble: 4 x 2
#>   board           n
#> * <chr>       <int>
#> 1 China-Drama   361
#> 2 EAseries      383
#> 3 KoreaDrama    369
#> 4 TaiwanDrama   344
### your code
as_tibble(df_main_clean%>%
filter(board=="KoreaDrama",comments>=50&comments<=100))
### your result should be
#> # A tibble: 62 x 10
#>    board  type   title   date       comments author  text      IP       link
#>    <chr>  <chr>  <chr>   <date>        <dbl> <chr>   <chr>     <chr>    <chr>
#>  1 Korea… [LIVE] [LIVE]… 2021-01-18       80 diana8… "───────… "※ 發信站:… https:/…
#>  2 Korea… [心得] [心得] 看… 2021-01-20       51 Eva041… "天啊~這次真的… "※ 發信站:… https:/…
#>  3 Korea… [閒聊] [閒聊] R… 2021-01-20       51 xji6tp… "繼續用愛發電防… "※ 發信站:… https:/…
#>  4 Korea… [LIVE] [LIVE]… 2021-01-20       75 kawasa… "EP13預告\… "※ 發信站:… https:/…
#>  5 Korea… [心得] [心得] 晝… 2021-01-21       80 lyw318… "一般追劇，要嘛… "※ 發信站:… https:/…
#>  6 Korea… [心得] [心得] 推… 2021-01-21       81 ilovef… "晝與夜是一部怪… "※ 發信站:… https:/…
#>  7 Korea… [閒聊] [閒聊] J… 2021-01-22       62 rainin… "[這是碎碎念]… "※ 發信站:… https:/…
#>  8 Korea… [心得] [心得] 女… 2021-01-23       61 Kduran… "因為目前很喜歡… "※ 發信站:… https:/…
#>  9 Korea… [心得] [心得] 《… 2021-01-26       63 analyt… "看到新聞說有人… "※ 發信站:… https:/…
#> 10 Korea… [心得] [心得] 看… 2021-01-26       56 n25 (n… "細部情節帶給人… "※ 發信站:… https:/…
#> # … with 52 more rows, and 1 more variable: time <dttm>
### your code
as.tibble(df_main_clean%>%
mutate(month = substr(df_main_clean$date,6,7))%>%
count(board,month))
### your result should be
#> # A tibble: 21 x 3
#>    board       month     n
#>    <chr>       <dbl> <int>
#>  1 China-Drama     1   135
#>  2 China-Drama     2   137
#>  3 China-Drama     3    24
#>  4 China-Drama     4     1
#>  5 China-Drama     8     1
#>  6 China-Drama    12    63
#>  7 EAseries        1   111
#>  8 EAseries        2   240
#>  9 EAseries        3    27
#> 10 EAseries        4     3
#> # … with 11 more rows
### your code
as.tibble(
df_main_clean%>%
filter(date=="2021-02-23"|date=="2021-02-24"|date=="2021-02-25"|date=="2021-02-26"|date=="2021-02-27"|date=="2021-02-28"|date=="2021-03-01")%>%
count(board,sort=TRUE)%>%
slice(1)%>%
select(n,board)
)
### your result should be
#> # A tibble: 1 x 2
#>       n board
#>   <int> <chr>
#> 1    56 EAseries
### your code
df_main_clean %>%
group_by(board, date) %>%
mutate(n = n()) %>%
ungroup() %>%
group_by(board) %>%
filter(n == max(n))%>%
arrange(desc(comments)) %>%
select(board,title,date,comments) %>%
slice(1,2)
### your result should be
#> # A tibble: 8 x 4
#> # Groups: board [4]
#> board title date comments
#> <chr> <chr> <date> <dbl>
#> 1 China-Drama [心得] 太過期待以致失望的有翡（含原著雷） 2021-01-24 415
#> 2 China-Drama [Live] 上陽賦 EP25 蕭綦高光即將開始 2021-01-24 337
#> 3 EAseries [心得] Wandavision S01E05 大暴雷啦!! 2021-02-05 182
#> 4 EAseries [請益] 是否可推薦帶入美式生活的影集 2021-01-22 94
#> 5 KoreaDrama [情報] 哲仁王后花絮 未公開畫面 金正賢專訪 2021-02-17 1352
#> 6 KoreaDrama [心得] 哲仁王后結局 2021-02-17 836
#> 7 TaiwanDrama [LIVE] 台視《生生世世》第162集 台視週間20:00 2020-12-30 266
#> 8 TaiwanDrama [LIVE] 愛不愛栗絲 第三集 2020-12-30 64
### your code
df_gapminder_clean%>%
filter(continent == "Europe")%>%
select(country,year,lifeExp,pop)%>%
arrange(desc(pop))%>%
group_by(country)%>%
slice(1)%>%
ungroup()%>%
arrange(desc(lifeExp))%>%
slice_head(n=10)%>%
arrange(country)
### your result should be
# 看你怎麼處理 missing value，結果可能會有不同
### your code
as.tibble(
df_gapminder_clean%>%
filter(continent == "Asia",year =="1972")%>%
mutate(total_GDP = pop*gdpPercap)%>%
arrange(desc(lifeExp))%>%
select(country,total_GDP,lifeExp))
### your result should be
# 看你怎麼處理 missing value，結果可能會有不同
df_gapminder_clean%>%
filter(continent == "Asia",year =="1972")
### your code
as.tibble(
df_gapminder_clean%>%
filter(continent == "Asia",year =="1972")%>%
mutate(total_GDP = pop*gdpPercap)%>%
arrange(desc(lifeExp))%>%
select(country,total_GDP,lifeExp))
### your result should be
# 看你怎麼處理 missing value，結果可能會有不同
knitr::opts_chunk$set(echo = TRUE, results = 'hold', comment = '#>', error = TRUE)
### your code
as.tibble(
df_gapminder_clean%>%
mutate(lifeexp_interval = ifelse(lifeExp >= "70", "too_old",
ifelse(lifeExp >= "60"&lifeExp < "70", "old",
ifelse((lifeExp < "60"&lifeExp > "0"), "young", "no"))))%>%
filter(continent == "Europe")%>%
count(lifeexp_interval))
### your result should be
# 看你怎麼處理 missing value，結果可能會有不同
### your text
#可以歐洲看到活到60、小於70歲的「old」的資料有85筆，超過70歲的「too_old」是250筆，有點活太久了。因為把所有NA變成0，所以葡萄牙的12筆NA被歸類到「no」。
# 範例：如前所述，我把數值變數的 missing value 都變成 88，在算它屬於哪個區間的時候會有影響，感覺不是好事，但我懶得改
knitr::opts_chunk$set(echo = TRUE)
#tidy_data %>%
#count(married)%>%view
village_stat <- tidy_data %>%
filter(agelower >= 20) %>%
group_by(vname) %>%
summarise(legalpopulation = sum(value),
eldersum = sum(value[agelower >= 65]),
marriedsum = sum(value[married %in% c("married","divorced","widowed")]),
womensum = sum(value[gender == "f"])) %>%
ungroup() %>%
left_join(raw %>% select(vname,site_id), by = "vname")
library(tidyverse)
options(stringsAsFactors = F)
options(scipen = 999)
raw <-read.csv("data/opendata107Y030.csv") %>%
slice(-1)%>%
mutate(vname = str_c(site_id,village))%>%
select(vname,everything())
raw %>%glimpse()
#mutate(vname = str_c(site_id,village))合併欄位
tidy_data <- raw %>%
gather("key","value",6:ncol(.)) %>%
mutate(key = str_replace(key,"_age","")) %>%
mutate(key = str_replace(key,"100up","100_110")) %>%
mutate(key = str_replace(key,"15down","0_15")) %>%
separate(key,c("married","agelower","ageupper","gender")) %>%
mutate(age = str(agelower,ageupper),
agelower = as.numeric(agelower),
ageupper = as.numeric(ageupper),
value = as.numeric(value)) %>%
select(-statistic_yyy) %>%
arrange(vname)
#tidy_data %>%
#count(married)%>%view
village_stat <- tidy_data %>%
filter(agelower >= 20) %>%
group_by(vname) %>%
summarise(legalpopulation = sum(value),
eldersum = sum(value[agelower >= 65]),
marriedsum = sum(value[married %in% c("married","divorced","widowed")]),
womensum = sum(value[gender == "f"])) %>%
ungroup() %>%
left_join(raw %>% select(vname,site_id), by = "vname")
#不懂為何要用value[agelower]
View(village_stat)
#tidy_data %>%
#count(married)%>%view
village_stat <- tidy_data %>%
filter(agelower >= 20) %>%
group_by(vname) %>%
summarise(legalpopulation = sum(value),
eldersum = sum(agelower >= 65),
marriedsum = sum(married %in% c("married","divorced","widowed")),
womensum = sum(value[gender == "f"])) %>%
ungroup() %>%
left_join(raw %>% select(vname,site_id), by = "vname")
#不懂為何要用value[agelower]
#tidy_data %>%
#count(married)%>%view
village_stat <- tidy_data %>%
filter(agelower >= 20) %>%
group_by(vname) %>%
summarise(legalpopulation = sum(value),
eldersum = sum(value[agelower >= 65]),
marriedsum = sum(value[married %in% c("married","divorced","widowed")]),
womensum = sum(value[gender == "f"])) %>%
ungroup() %>%
left_join(raw %>% select(vname,site_id), by = "vname")
#不懂為何要用value[agelower]
tidy_data <- raw %>%
gather("key","value",6:ncol(.)) %>%
mutate(key = str_replace(key,"_age","")) %>%
mutate(key = str_replace(key,"100up","100_110")) %>%
mutate(key = str_replace(key,"15down","0_15")) %>%
separate(key,c("married","agelower","ageupper","gender")) %>%
mutate(age = str(agelower,ageupper),
agelower = as.numeric(agelower),
ageupper = as.numeric(ageupper),
value = as.numeric(value)) %>%
select(-statistic_yyy) %>%
arrange(vname)
View(tidy_data)
tidy_data <- raw %>%
gather("key","value",6:ncol(.)) %>%
mutate(key = str_replace(key,"_age","")) %>%
mutate(key = str_replace(key,"100up","100_110")) %>%
mutate(key = str_replace(key,"15down","0_15"))
View(raw)
tidy_data <- raw %>%
gather("key","value",6:ncol(.)) %>%
mutate(key = str_replace(key,"_age","")) %>%
mutate(key = str_replace(key,"100up","100_110")) %>%
mutate(key = str_replace(key,"15down","0_15")) %>%
separate(key,c("married","agelower","ageupper","gender"))
tidy_data <- raw %>%
gather("key","value",6:ncol(.)) %>%
mutate(key = str_replace(key,"_age","")) %>%
mutate(key = str_replace(key,"100up","100_110")) %>%
mutate(key = str_replace(key,"15down","0_15")) %>%
separate(key,c("married","agelower","ageupper","gender")) %>%
mutate(age = str(agelower,ageupper),
agelower = as.numeric(agelower),
ageupper = as.numeric(ageupper),
value = as.numeric(value)) %>%
select(-statistic_yyy) %>%
arrange(vname)
tidy_data <- raw %>%
gather("key","value",6:ncol(.)) %>%
mutate(key = str_replace(key,"_age","")) %>%
mutate(key = str_replace(key,"100up","100_110")) %>%
mutate(key = str_replace(key,"15down","0_15")) %>%
separate(key,c("married","agelower","ageupper","gender")) %>%
mutate(age = str(agelower,ageupper),
agelower = as.numeric(agelower),
ageupper = as.numeric(ageupper),
value = as.numeric(value))
ref10$agree <- as.integer(str_remove_all(ref10$agree, ","))
tidy_data <- raw %>%
gather("key","value",6:ncol(.)) %>%
mutate(key = str_replace(key,"_age","")) %>%
mutate(key = str_replace(key,"100up","100_110")) %>%
mutate(key = str_replace(key,"15down","0_15")) %>%
separate(key,c("married","agelower","ageupper","gender")) %>%
mutate(age = str(agelower,ageupper),
agelower = as.numeric(agelower),
ageupper = as.numeric(ageupper),
value = as.numeric(value)) %>%
select(-statistic_yyy) %>%
arrange(vname)
#tidy_data %>%
#count(married)%>%view
village_stat <- tidy_data %>%
filter(agelower >= 20) %>%
group_by(vname) %>%
summarise(legalpopulation = sum(value),
eldersum = sum(value[agelower >= 65]),
marriedsum = sum(value[married %in% c("married","divorced","widowed")]),
womensum = sum(value[gender == "f"])) %>%
ungroup() %>%
left_join(raw %>% select(vname,site_id), by = "vname")
#left_join(village_stat,raw,by = "vname")
village_stat %>%
left_join(raw %>% select(vname,site_id), by = "vname") %>%head
town_stat <- village_stat %>%
mutate(site_id = str_replace(site_id,"三民一|三民二","三民區")) %>%
mutate(site_id = str_replace(site_id,"鳳山一|鳳山二","鳳山區")) %>%
group_by(site_id) %>%
summarise(legalpopulation = sum(legalpopulation),
eldersum = sum(eldersum),
marriedsum = sum(marriedsum),
womensum = sum(womensum)) %>%
ungroup()
#改區名就會自己兩列加總喔？
town_stat %>%
mutate(marriedperc = marriedsum / legalpopulation) %>%
mutate(womenperc = womensum / legalpopulation) %>%
mutate(elderperc = eldersum / legalpopulation) %>%
ggplot()+
aes(marriedperc,elderperc)+
geom_jitter(alpha = 0.3)
ref10 <- read.csv("data/referendum_byTown/ref10.csv") %>%
select(county = 縣市,town = 鄉鎮市區,
agree = 同意票數,disagree = 不同意票數,
legalvote = 有效票數,illegalvote = 無效票數,
vote = 投票數,legalpopulation = 投票權人數) %>%
mutate(site_id = str_c(county,town)) %>%
drop_na(site_id)
names(ref10)
#filter不是NA的也可以
ref10$agree <- as.integer(str_remove_all(ref10$agree, ","))
ref10$legalvote <- as.integer(str_remove_all(ref10$legalvote, ","))
town_stat %>%
mutate(site_id = str_replace(site_id,"東 區","東區"),
site_id = str_replace(site_id,"西 區","西區"),
site_id = str_replace(site_id,"南 區","南區"),
site_id = str_replace(site_id,"北 區","北區"),
site_id = str_replace(site_id,"中 區","中區"))%>%
left_join(ref10 %>%
mutate(as.integer(str_remove_all(agree, ","))) %>%
mutate(as.integer(str_remove_all(legalvote, ","))) ,by = "site_id") %>%
mutate(agreerate = agree / legalvote,
marriedperc = marriedsum / legalpopulation.x)%>%
ggplot()+
aes(agreerate,marriedperc)+
geom_jitter(alpha = 0.5 , color = "royalblue")+
theme_light()
#ref10$agree <- as.integer(str_remove_all(ref10$agree, ","))
#ref10$legalvote <- as.integer(str_remove_all(ref10$legalvote, ","))
town_stat %>%
mutate(site_id = str_replace(site_id,"東 區","東區"),
site_id = str_replace(site_id,"西 區","西區"),
site_id = str_replace(site_id,"南 區","南區"),
site_id = str_replace(site_id,"北 區","北區"),
site_id = str_replace(site_id,"中 區","中區"))%>%
left_join(ref10 %>%
mutate(as.integer(str_remove_all(agree, ","))) %>%
mutate(as.integer(str_remove_all(legalvote, ","))) ,by = "site_id") %>%
mutate(agreerate = agree / legalvote,
marriedperc = marriedsum / legalpopulation.x)%>%
ggplot()+
aes(agreerate,marriedperc)+
geom_jitter(alpha = 0.5 , color = "royalblue")+
theme_light()
town_stat %>%
mutate(site_id = str_replace(site_id,"東 區","東區"),
site_id = str_replace(site_id,"西 區","西區"),
site_id = str_replace(site_id,"南 區","南區"),
site_id = str_replace(site_id,"北 區","北區"),
site_id = str_replace(site_id,"中 區","中區"))
View(ref10)
#ref10$agree <- as.integer(str_remove_all(ref10$agree, ","))
#ref10$legalvote <- as.integer(str_remove_all(ref10$legalvote, ","))
town_stat %>%
mutate(site_id = str_replace(site_id,"東 區","東區"),
site_id = str_replace(site_id,"西 區","西區"),
site_id = str_replace(site_id,"南 區","南區"),
site_id = str_replace(site_id,"北 區","北區"),
site_id = str_replace(site_id,"中 區","中區"))%>%
left_join(ref10 %>%
mutate(as.integer(agree)) %>%
mutate(as.integer(legalvote)) ,by = "site_id") %>%
mutate(agreerate = agree / legalvote,
marriedperc = marriedsum / legalpopulation.x)%>%
ggplot()+
aes(agreerate,marriedperc)+
geom_jitter(alpha = 0.5 , color = "royalblue")+
theme_light()
#ref10$agree <- as.integer(str_remove_all(ref10$agree, ","))
#ref10$legalvote <- as.integer(str_remove_all(ref10$legalvote, ","))
town_stat %>%
mutate(site_id = str_replace(site_id,"東 區","東區"),
site_id = str_replace(site_id,"西 區","西區"),
site_id = str_replace(site_id,"南 區","南區"),
site_id = str_replace(site_id,"北 區","北區"),
site_id = str_replace(site_id,"中 區","中區"))%>%
left_join(ref10 %>%
mutate(as.integer(str_remove_all(agree, ","))) %>%
mutate(as.integer(str_remove_all(legalvote, ","))) ,by = "site_id") %>%
mutate(agreerate = agree / legalvote,
marriedperc = marriedsum / legalpopulation.x)%>%
ggplot()+
aes(agreerate,marriedperc)+
geom_jitter(alpha = 0.5 , color = "royalblue")+
theme_light()
>>>>>>> Stashed changes
