top_n(20, abs(diff)) %>%
ungroup() %>%view
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>% view
### your code
cutter <- worker()
tagger <- worker("tag")
stopWords <- readRDS("data/AS06/stopWords.rds")
no_word <- c("掌聲","一個","政府","未來","我們","使","今日","乃是","亦","再","唯","公","人","此一","公","新","過去","四年","中","持續","今天","之上","年","一百三十","萬","支柱","一塊","我會","事情","更好","相同","邁進","之間","兩千","經由","現場","最","應該","我要")
segment_not <- c("台灣","臺灣","馬英九","李登輝","蔡英文","蔣經國")
new_user_word(cutter, segment_not)
new_user_word(tagger, segment_not)
unnested.df <- df_speech%>%
mutate(word = purrr::map(text, function(x)segment(x, tagger))) %>%
select(id,president,year,word) %>%
mutate(word = purrr::map(word, function(x)str_c(names(x),"_",x))) %>%
unnest(word) %>%
separate(word,c("pos","word"),sep = "_" ) %>%
filter(word != "　") %>%
filter(!(word %in% stopWords$word)) %>%
filter(!(word %in% no_word)) %>%
filter(!str_detect(word, "[a-zA-Z0-9]+")) %>%
mutate(word = str_replace(word,"臺灣","台灣"))
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>% view
ggplot() + aes(word, diff, fill = diff > 0) +
geom_col() +
ylab("詞彙")+
xlab("次數")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "？？")
### your result should be
# 自己畫就好唷
### your code
cutter <- worker()
tagger <- worker("tag")
stopWords <- readRDS("data/AS06/stopWords.rds")
no_word <- c("掌聲","一個","政府","未來","我們","使","今日","乃是","亦","再","唯","公","人","此一","公","新","過去","四年","中","持續","今天","之上","年","一百三十","萬","支柱","一塊","我會","事情","更好","相同","邁進","之間","兩千","經由","現場","最","應該","我要","前")
segment_not <- c("台灣","臺灣","馬英九","李登輝","蔡英文","蔣經國")
new_user_word(cutter, segment_not)
new_user_word(tagger, segment_not)
unnested.df <- df_speech%>%
mutate(word = purrr::map(text, function(x)segment(x, tagger))) %>%
select(id,president,year,word) %>%
mutate(word = purrr::map(word, function(x)str_c(names(x),"_",x))) %>%
unnest(word) %>%
separate(word,c("pos","word"),sep = "_" ) %>%
filter(word != "　") %>%
filter(!(word %in% stopWords$word)) %>%
filter(!(word %in% no_word)) %>%
filter(!str_detect(word, "[a-zA-Z0-9]+")) %>%
mutate(word = str_replace(word,"臺灣","台灣"))
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>% view
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
#arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>% view
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>% view
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill = diff > 0) +
geom_col() +
ylab("詞彙")+
xlab("次數")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "？？")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill = diff > 0) +
geom_col() +
coord_flip() +
ylab("詞彙")+
xlab("次數")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "？？")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill = diff > 0) +
geom_col() +
coord_flip() +
ylab("詞彙")+
xlab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
cutter <- worker()
tagger <- worker("tag")
stopWords <- readRDS("data/AS06/stopWords.rds")
no_word <- c("掌聲","一個","政府","未來","我們","使","今日","乃是","亦","再","唯","公","人","此一","公","新","過去","四年","中","持續","今天","之上","年","一百三十","萬","支柱","一塊","我會","事情","更好","相同","邁進","之間","兩千","經由","現場","最","應該","我要","前","一起")
segment_not <- c("台灣","臺灣","馬英九","李登輝","蔡英文","蔣經國")
new_user_word(cutter, segment_not)
new_user_word(tagger, segment_not)
unnested.df <- df_speech%>%
mutate(word = purrr::map(text, function(x)segment(x, tagger))) %>%
select(id,president,year,word) %>%
mutate(word = purrr::map(word, function(x)str_c(names(x),"_",x))) %>%
unnest(word) %>%
separate(word,c("pos","word"),sep = "_" ) %>%
filter(word != "　") %>%
filter(!(word %in% stopWords$word)) %>%
filter(!(word %in% no_word)) %>%
filter(!str_detect(word, "[a-zA-Z0-9]+")) %>%
mutate(word = str_replace(word,"臺灣","台灣"))
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill = diff > 0) +
geom_col() +
coord_flip() +
ylab("詞彙")+
xlab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
geom_col() +
coord_flip() +
ylab("詞彙")+
xlab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#613030","#C48888"))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#4F9D9D","#005AB5"))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#4F9D9D","#005AB5"))+
scale_x_continuous(limits = c(0,50),breaks = seq(0,50,10))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#4F9D9D","#005AB5"))+
scale_y_continuous(limits = c(0,50),breaks = seq(0,50,10))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#4F9D9D","#005AB5"))+
scale_y_continuous(limits = c(-50,50),breaks = seq(0,50,10))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#4F9D9D","#005AB5"))+
scale_y_continuous(limits = c(-10,50),breaks = seq(0,50,10))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#4F9D9D","#005AB5"))+
scale_y_continuous(limits = c(-50,50),breaks = seq(0,50,10))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#4F9D9D","#005AB5"))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
### your code
unnested.df %>%
filter(president == c("蔡英文","馬英九")) %>%
count(word,president) %>%
spread(president, n, fill = 0) %>%
mutate(diff = 蔡英文-馬英九) %>%
arrange(-diff) %>%
group_by(diff > 0) %>%
top_n(10, abs(diff)) %>%
ungroup() %>%
mutate(word = reorder(word, diff)) %>%
ggplot() + aes(word, diff, fill =ifelse (diff > 0, "蔡英文","馬英九")) +
scale_fill_manual(values =c("#4F9D9D","#005AB5"))+
scale_y_continuous(limits = c(-20,20),breaks = seq(-20,20,10))+
geom_col() +
coord_flip() +
xlab("詞彙")+
ylab("使用次數差異")+
theme_bw()+
theme(text=element_text(family="黑體-繁 中黑", size=10),
legend.title=element_blank(),
legend.position = "top",
panel.border = element_blank(),
panel.grid.minor = element_blank())+
labs(title = "馬英九與蔡英文使用差異最大詞彙")
### your result should be
# 自己畫就好唷
